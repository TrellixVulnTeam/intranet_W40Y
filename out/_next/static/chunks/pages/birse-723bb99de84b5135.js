(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[391],{3976:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/birse",function(){return n(8774)}])},3576:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var i=n(5893),s=n(4949),r=n.n(s),u=n(9004),a=n.n(u),o=n(765),c=n(7294),l=n(1163),d=n.n(l),f=n(5152),h=(n(2462),(0,f.default)((function(){return Promise.all([n.e(714),n.e(876),n.e(829)]).then(n.t.bind(n,1288,23))}),{loadableGenerated:{webpack:function(){return[1288]}},ssr:!1}));function p(e){var t=e.id,n=e.type,s=e.name,r=e.strass,u=e.setPublisMounted,l=(0,c.useState)(),f=l[0],p=l[1],m=(0,c.useState)(),b=m[0],j=m[1],v=(0,c.useState)(!1),x=v[0],y=v[1],N=(0,c.useState)(!1),E=N[0],S=N[1];(0,c.useEffect)((function(){d().query.id?(0,o.Z)("/publis/id/"+t).then((function(e){p(e[0].title),j(e[0].content),y(!0)})):y(!0)}),[d().query.id]),(0,c.useEffect)((function(){E&&setTimeout((function(){alert("Nouveau contenu ajout\xe9 !"),S(!1)}),100)}),[E]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:"Ajouter un nouveau contenu - "+s}),(0,i.jsxs)("form",{onSubmit:function(e){e.preventDefault();var i="POST",s=function(){var e=new Date,t=function(e,t,n){var i=6e4*e.getTimezoneOffset();return new Date(e.valueOf()+i).toLocaleDateString(t,n)}(e,"fr-FR",{weekday:"short",year:"numeric",month:"numeric",day:"2-digit"}),n=("0"+e.getHours()).slice(-2)+" h "+("0"+e.getMinutes()).slice(-2);return(t+" \xe0 "+n).replace(/(^\w{1})|(\s+\w{1})/g,(function(e){return e.toUpperCase()}))}();d().query.id&&(i="PUT"),(0,o.W)("/publis",i,{title:f,content:b,date:s,strass:r,type:n,id:t}).then((function(e){200==e&&(d().push(d().asPath.split("?")[0]),S(!0),u(!1))}))},className:a().formulaire,children:[(0,i.jsxs)("label",{children:[(0,i.jsx)("p",{className:"texte",children:"Ajouter un titre"}),(0,i.jsx)("input",{type:"text",onChange:function(e){return p(e.target.value)},className:"field",placeholder:"Titre ...",value:f,required:!0})]}),(0,i.jsxs)("div",{className:a().editor,children:[(0,i.jsx)("p",{className:"texte",children:"Contenu"}),x?(0,i.jsx)(h,{setContents:b,onChange:function(e){return j(e)},height:"200px",placeholder:"Contenu ...",setOptions:{buttonList:[["font","fontSize","fontColor","hiliteColor"],["bold","underline","italic","strike","subscript","superscript"],["image","video","audio","link"]]}}):void 0]}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{type:"submit",className:"submit",children:"Publier"})})]})]})}var m=n(1664),b=n.n(m),j=n(9424);function v(e){var t=e.type,n=e.name,s=e.authStrass,u=e.selectStrass,a=(0,c.useState)(!1),l=a[0],f=a[1],h=(0,c.useState)([]),m=h[0],v=h[1],x=(0,c.useState)(!1),y=x[0],N=x[1];(0,c.useEffect)((function(){l&&setTimeout((function(){alert("Contenu supprim\xe9"),f(!1)}),100)}),[l]),(0,c.useEffect)((function(){y||(0,o.Z)("/publis/type/"+t).then((function(e){v(e),N(!0)}))}),[y]);switch(d().query.action){case"add":if(s.includes(u.cn))return(0,i.jsx)("div",{className:r().global,children:(0,i.jsx)(p,{strass:u,type:t,name:n,setPublisMounted:N})});case"modify":if(d().query.id&&s.includes(u.cn))return(0,i.jsx)("div",{className:r().global,children:(0,i.jsx)(p,{id:d().query.id,type:t,name:n,setPublisMounted:N})});default:return(0,i.jsxs)("div",{className:r().global,children:[(0,i.jsx)("h1",{children:n}),s.includes(u.cn)?(0,i.jsx)(b(),{href:d().asPath.split("?")[0]+"?action=add",passHref:!0,children:(0,i.jsx)("h4",{className:"boutonAjout",children:"Ajouter une publication"})}):void 0,null===m||void 0===m?void 0:m.map((function(e){return(0,i.jsx)(j.Z,{publi:e,children:e.strass==u.cn||"AE"==u.cn?(0,i.jsxs)("div",{className:r().sectionEdit,children:[(0,i.jsx)(b(),{href:d().asPath.split("?")[0]+"?action=modify&id="+e.id,passHref:!0,children:(0,i.jsx)("h4",{className:"boutonEdit",children:"Modifier"})}),(0,i.jsx)("button",{onClick:function(){return t=e.id,void(0,o.W)("/publis","DELETE",{id:t}).then((function(e){200==e&&(N(!1),f(!0))}));var t},children:(0,i.jsx)("h4",{className:"boutonEdit",children:"Supprimer"})})]}):void 0},e.id)}))]})}}},8774:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return r}});var i=n(5893),s=n(3576);function r(e){var t=e.selectStrass;return(0,i.jsx)(s.Z,{type:"birse",name:"Birse - Bien-\xeatre",authStrass:["DAP","estime","AE"],selectStrass:t})}},9004:function(e){e.exports={formulaire:"Formulaire_formulaire__030Vg"}}},function(e){e.O(0,[719,774,888,179],(function(){return t=3976,e(e.s=t);var t}));var t=e.O();_N_E=t}]);