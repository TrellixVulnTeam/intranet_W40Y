(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[391],{3976:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/birse",function(){return n(8774)}])},3576:function(e,t,n){"use strict";n.d(t,{Z:function(){return j}});var i=n(5893),s=n(4949),r=n.n(s),a=n(9004),u=n.n(a),l=n(765),o=n(7294),c=n(1163),d=n.n(c),f=n(5152),h=(n(2462),(0,f.default)((function(){return Promise.all([n.e(714),n.e(876),n.e(829)]).then(n.t.bind(n,1288,23))}),{loadableGenerated:{webpack:function(){return[1288]}},ssr:!1})),p=(0,f.default)((function(){return n.e(127).then(n.t.bind(n,2138,23))}),{loadableGenerated:{webpack:function(){return[2138]}},ssr:!1});function m(e){var t=e.id,n=e.type,s=e.name,r=e.strass,a=(0,o.useState)(),c=a[0],f=a[1],m=(0,o.useState)(),b=m[0],_=m[1],j=(0,o.useState)(!1),x=j[0],v=j[1],y=(0,o.useState)(!1),N=y[0],g=y[1];(0,o.useEffect)((function(){d().query.id?(0,l.Z)("/publis/id/"+t).then((function(e){f(e[0].title),_(e[0].content),v(!0)})):v(!0)}),[]),(0,o.useEffect)((function(){N&&setTimeout((function(){alert("Nouveau contenu ajout\xe9 !"),g(!1)}),100)}),[N]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:"Ajouter un nouveau contenu - "+s}),(0,i.jsxs)("form",{onSubmit:function(e){e.preventDefault();var i="POST",s=function(){var e=new Date,t=function(e,t,n){var i=6e4*e.getTimezoneOffset();return new Date(e.valueOf()+i).toLocaleDateString(t,n)}(e,"fr-FR",{weekday:"long",year:"numeric",month:"long",day:"2-digit"}),n=("0"+e.getHours()).slice(-2)+" h "+("0"+e.getMinutes()).slice(-2);return(t+" \xe0 "+n).replace(/(^\w{1})|(\s+\w{1})/g,(function(e){return e.toUpperCase()}))}();d().query.id&&(i="PUT"),(0,l.W)("/publis",i,{title:c,content:b,date:s,strass:r,type:n,id:t}).then((function(e){200==e&&(d().push(d().asPath.split("?")[0]),g(!0))}))},className:u().formulaire,children:[(0,i.jsxs)("label",{children:[(0,i.jsx)("p",{className:"texte",children:"Ajouter un titre"}),(0,i.jsx)("input",{type:"text",onChange:function(e){return f(e.target.value)},className:"field",placeholder:"Je suis un titre !",value:c,required:!0})]}),(0,i.jsxs)("div",{className:u().editor,children:[(0,i.jsx)("p",{className:"texte",children:"Contenu"}),x?(0,i.jsx)(h,{setContents:b,onChange:function(e){_(e)},height:"200px",setOptions:{buttonList:[["undo","redo"],["font","fontSize","formatBlock"],["paragraphStyle","blockquote"],["bold","underline","italic","strike","subscript","superscript"],["fontColor","hiliteColor","textStyle"],["removeFormat"],["outdent","indent"],["align","horizontalRule","list","lineHeight"],["fullScreen"],["image","video","audio","link"]]}}):void 0,(0,i.jsx)(p,{onEmojiClick:function(e,t){_(b+t.emoji)},pickerStyle:{width:"100%"}})]}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{type:"submit",className:"submit",children:"Publier"})})]})]})}var b=n(1664),_=n.n(b);function j(e){var t=e.type,n=e.name,s=e.authStrass,a=e.selectStrass,u=(0,o.useState)(!1),c=u[0],f=u[1],h=(0,o.useState)([]),p=h[0],b=h[1];switch((0,o.useEffect)((function(){c&&setTimeout((function(){alert("Contenu supprim\xe9"),f(!1)}),100)}),[c]),(0,o.useEffect)((function(){(0,l.Z)("/publis/type/"+t).then((function(e){return b(e)}))}),[d().query.id,d().query.action]),d().query.action){case"add":if(s.includes(a.cn))return(0,i.jsx)("div",{className:r().global,children:(0,i.jsx)(m,{strass:a,type:t,name:n})});case"modify":if(d().query.id&&s.includes(a.cn))return(0,i.jsx)("div",{className:r().global,children:(0,i.jsx)(m,{id:d().query.id,type:t,name:n})});case"delete":if(d().query.id&&s.includes(a.cn)){var j=d().query.id;(0,l.W)("/publis","DELETE",{id:j}).then((function(e){200==e&&(d().push(d().asPath.split("?")[0]),f(!0))}))}default:return(0,i.jsxs)("div",{className:r().global,children:[(0,i.jsx)("h1",{children:n}),s.includes(a.cn)?(0,i.jsx)(_(),{href:d().asPath.split("?")[0]+"?action=add",passHref:!0,children:(0,i.jsx)("h4",{className:"boutonAjout",children:"Ajouter une publication"})}):void 0,null===p||void 0===p?void 0:p.map((function(e){return(0,i.jsxs)("section",{className:r().section,children:[(0,i.jsxs)("div",{className:r().header,children:[(0,i.jsx)("h4",{className:r().title,children:e.title}),(0,i.jsxs)("p",{className:r().strass,children:["Publi\xe9 le ",e.date," par ",e.strassName]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:e.content},className:r().content}),e.strass==a.cn||"AE"==a.cn?(0,i.jsxs)("div",{className:r().sectionEdit,children:[(0,i.jsx)(_(),{href:d().asPath.split("?")[0]+"?action=modify&id="+e.id,passHref:!0,children:(0,i.jsx)("h4",{className:"boutonEdit",children:"Modifier"})}),(0,i.jsx)(_(),{href:d().asPath.split("?")[0]+"?action=delete&id="+e.id,passHref:!0,children:(0,i.jsx)("h4",{className:"boutonEdit",children:"Supprimer"})})]}):void 0]},e.id)}))]})}}},8774:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return r}});var i=n(5893),s=n(3576);function r(e){var t=e.selectStrass;return(0,i.jsx)(s.Z,{type:"birse",name:"Birse - Bien-\xeatre",authStrass:["DAP","estime","AE"],selectStrass:t})}},9004:function(e){e.exports={formulaire:"Formulaire_formulaire__030Vg",editor:"Formulaire_editor__Of4ic"}},4949:function(e){e.exports={global:"Publis_global__BDV6t",section:"Publis_section__DLiC1",header:"Publis_header__RuBFX",title:"Publis_title__5Nodf",strass:"Publis_strass__NnDzQ",content:"Publis_content__SYQ5d",sectionEdit:"Publis_sectionEdit__9cTXL"}}},function(e){e.O(0,[719,774,888,179],(function(){return t=3976,e(e.s=t);var t}));var t=e.O();_N_E=t}]);